{% extends 'base.html' %}

{% block title %}Home - To Do App{% endblock %}

{% block content %}
<div class="welcome-section">
    <h2>Welcome, {{ session_username }}!</h2>
    <p>Manage your tasks efficiently and stay organized with our intuitive task management system.</p>
</div>

<a href="{% url 'add_task' %}" class="add-task-btn">
    <i class="fas fa-plus"></i> Add New Task
</a>

<div class="tasks-section">
    <h3><i class="fas fa-list-check"></i> Your Tasks</h3>

    {% if tasks %}
    <div class="table-container">
        <table>
            <thead>
                <tr>
                    <th>Title</th>
                    <th>Description</th>
                    <th>Date</th>
                    <th>Time</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for task in tasks %}
                <tr>
                    <td>{{ task.title }}</td>
                    <td>{{ task.description }}</td>
                    <td>{{ task.date }}</td>
                    <td>{{ task.time }}</td>
                    <td>
                        <div class="action-links">
                            <a href="{% url 'edit_task' task.task_id %}" class="action-link edit-link">
                                <i class="fas fa-edit"></i> Edit
                            </a>
                            <a href="#" 
                               onclick="showDeleteModal('{{ task.task_id }}', '{{ task.title|escapejs }}', '{{ task.description|escapejs }}', '{{ task.date }}', '{{ task.time }}')"
                               class="action-link delete-link">
                                <i class="fas fa-trash"></i> Delete
                            </a>
                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
        <div class="no-tasks">
            <i class="fas fa-clipboard-list"></i>
            <p>No tasks available. Create your first task to get started!</p>
        </div>
    {% endif %}
</div>

<!-- Delete Confirmation Modal -->
<div id="deleteModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <i class="fas fa-exclamation-triangle fa-lg"></i>
            <h3>Confirm Deletion</h3>
        </div>
        
        <div class="modal-body">
            <p><strong>Are you sure you want to delete this task?</strong></p>
            <div class="task-details">
                <div class="task-detail-item">
                    <span class="task-detail-label">Title:</span>
                    <span id="modalTaskTitle"></span>
                </div>
                <div class="task-detail-item">
                    <span class="task-detail-label">Description:</span>
                    <span id="modalTaskDescription"></span>
                </div>
                <div class="task-detail-item">
                    <span class="task-detail-label">Date:</span>
                    <span id="modalTaskDate"></span>
                </div>
                <div class="task-detail-item">
                    <span class="task-detail-label">Time:</span>
                    <span id="modalTaskTime"></span>
                </div>
            </div>
            
            <p style="color: var(--danger); font-weight: bold; margin-top: 1rem;">
                <i class="fas fa-exclamation-circle"></i> This action cannot be undone!
            </p>
        </div>
        
        <div class="modal-actions">
            <form id="deleteForm" method="post" action="">
                {% csrf_token %}
                <button type="submit" class="btn-danger">
                    <i class="fas fa-trash"></i> Yes, Delete Task
                </button>
            </form>
            <button onclick="hideDeleteModal()" class="btn-secondary">
                <i class="fas fa-times"></i> Cancel
            </button>
        </div>
    </div>
</div>
{% endblock %}